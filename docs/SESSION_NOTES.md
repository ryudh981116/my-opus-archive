# 세션 개발 일지 (Session Notes)

> 이 파일은 이전 세션의 개발 과정, 주요 프롬프트, 해결 방법을 기록합니다.

---

## 📋 현재 세션 (Session 5: 2026-02-13)

### 목표
UI/UX 개선 및 사용자 경험 최적화

### 완료 작업

#### 1. 공연 기록 수정 기능 구현 (9f1366b)
**프롬프트**: "공연 기록을 수정할 수 있도록 해줘"

**구현 내용**:
- "내 연주 내역" 페이지에 ✏️ 버튼 추가
- 기존 정보가 프리필된 수정 폼
- `update_performance()` 함수로 저장
- 수정 완료 후 목록으로 복귀

**학습**: `st.session_state.editing_perf_id`로 편집 모드 상태 관리

#### 2. 로그인 페이지 정리 (a006649)
**프롬프트**: "로그인 페이지 정리 - 중복 제목 제거, 주요 기능 제거, 컴팩트한 레이아웃"

**변경사항**:
- ❌ 중복된 "🎵 My Opus Archive" 제목 제거
- ❌ "주요 기능" 섹션 완전 삭제
- 📦 로그인 폼을 가운데 정렬 + 컴팩트 너비 (col [1,2,1])

#### 3. 네비게이션 바 개선 (6eb9a61)
**프롬프트**: "로그인 이전엔 좌측 네비게이션 바가 안보이고, 로그인 이후 보였으면 좋겠어. 그리고 이상한 이모지랑 네비게이션 이라고 써있는거 없애줘"

**구현**:
- 🔒 로그인 전: 네비게이션 바 완전 숨김
- 🔓 로그인 후: 네비게이션 바만 표시
- 🗑️ `st.sidebar.title("🎭 네비게이션")` 제거
- 🗑️ `st.sidebar.subheader("📑 페이지")` 제거

#### 4. 회원가입 후 자동 전환 (0a3ef9b → 2694df9 → fc618b6)
**프롬프트**: "회원가입 성공하고나면 자동으로 입력된 것들 다 지우고 로그인 화면으로 전환되는게 좋을 것 같아"

**초기 시도 (0a3ef9b)**:
- 문제: `st.tabs()`는 세션 상태로 활성 탭을 제어할 수 없음
- 해결: `st.session_state.active_auth_tab` 상태 변수 추가

**재시도 (fc618b6)**:
- 사용자 요청: "회원가입으로 전환 버튼은 부적절해. 원래 있던거로 바꿔"
- `st.tabs()` 복원

**최종 구현 (2694df9)**:
- ❌ 탭 전환 버튼 제거
- ✅ 버튼 형식 탭 시스템으로 변경
  - "🔐 로그인" / "✍️ 회원가입"
  - primary/secondary 스타일로 활성 탭 표시
- ✅ 회원가입 성공 후 자동 로그인 화면 전환

#### 5. 회원가입 성공 메시지 표시 (05bafb9)
**프롬프트**: "회원가입 성공! 메시지가 어딘가에 표시는 될 텐데 바로 로그인 화면으로 전환되어서 안보이네"

**해결**:
- `import time` 추가
- 성공 메시지 표시 후 `time.sleep(1.5)` 대기
- 1.5초 후 로그인 탭으로 자동 전환

**코드 패턴**:
```python
if success:
    st.success("✅ 회원가입 성공!")
    time.sleep(1.5)  # 메시지 표시 시간
    st.session_state.active_auth_tab = 0
    st.rerun()
```

### 현재 미해결 이슈

#### 1. 곡목 데이터베이스
**프롬프트**: "곡목의 경우에는 각각 작곡가 선택, 서곡/협주곡/교향곡/모음곡/기타 로 구분할수있고..."

**상태**: 미구현 (추후 해결)
**예상 투입 시간**: 3-4시간
**필요한 데이터**:
- composers.json (작곡가)
- compositions.json (곡)
  - 작곡가별
  - 유형별 (협주곡 시 악기 지정)
  - 기본 곡 데이터 많이 필요

---

## 🎓 기술 깊이 있는 학습들

### 1. Streamlit 탭 시스템의 한계
**문제**: `st.tabs()`는 세션 상태로 활성 탭을 제어할 수 없음

**원인**: `st.tabs()`는 렌더링 시점에만 활성 탭이 결정되고, 세션 상태 변경 후 `st.rerun()`해도 상태가 반영되지 않음

**해결 방법**:
```python
# ❌ 안 됨
tab1, tab2 = st.tabs(["로그인", "회원가입"])
# ... st.session_state 변경 시도 → 탭이 변경 안 됨

# ✅ 됨: 조건부 렌더링
if st.session_state.active_tab == 0:
    # 로그인 화면
else:
    # 회원가입 화면
```

### 2. `time.sleep()` 사용의 중요성
**학습**: Streamlit에서 메시지를 일정 시간 표시하려면, `st.rerun()`이 실행되기 전에 `time.sleep()`으로 시간을 벌어야 함

```python
st.success("메시지")
time.sleep(1.5)  # 메시지가 보일 시간
st.rerun()       # 화면 업데이트 시 메시지 사라짐
```

---

## 🔄 세션 타임라인

| 시간 | 작업 | 커밋 | 상태 |
|------|------|------|------|
| T+0 | 공연 수정 기능 | 9f1366b | ✅ |
| T+15분 | 로그인 페이지 정리 | a006649 | ✅ |
| T+30분 | 네비게이션 바 개선 | 6eb9a61 | ✅ |
| T+45분 | 회원가입 후 자동 전환 (3회 시도) | 0a3ef9b, fc618b6, 2694df9 | ✅ |
| T+60분 | 회원가입 메시지 표시 | 05bafb9 | ✅ |
| T+75분 | 문서화 | docs 업데이트 | 진행 중 |

---

## 📊 세션 성과

### 구현된 기능
- ✅ 공연 기록 수정 (CRUD 완성)
- ✅ 회원가입 UX 개선
- ✅ 네비게이션 바 동적 표시
- ✅ 깔끔한 로그인 레이아웃

### 코드 개선
- +101줄 (수정 기능)
- -65줄 (UI 정리)
- +20줄 (탭 시스템 개선)
- +2줄 (메시지 대기)

### 커밋 수
- 총 7개 (이 세션)
- GitHub 푸시 완료

---

## 🎯 다음 세션 추천

### Priority 1: 클래식 곡목 데이터베이스
- 가장 중요한 미완성 기능
- 사용자 경험 향상에 필수
- 투입 시간: 3-4시간

### Priority 2: 개선 사항
- 비밀번호 해싱 (보안)
- 댓글 입력값 완전 초기화 (간단함)

### Priority 3: 고급 기능
- CSV/PDF 내보내기
- 데이터베이스 마이그레이션

---

## 💡 메모

### 사용자 데이터
**파일**: `data/users.json`

| 사용자명 | 비밀번호 | 이메일 |
|---------|---------|--------|
| 다현 | 1234 | ryudh98@gmail.com |
| 22 | 1234 | sinksda@naver.com |

**⚠️ 주의**: 비밀번호가 평문(plaintext)으로 저장 중. 반드시 해싱 필요.

### 개발 패턴
1. `st.session_state` 초기화 (페이지 시작)
2. 조건별 UI 렌더링
3. 사용자 상호작용 감지 & 처리
4. 필요시 `st.rerun()` 호출
5. 파일 저장 (JSON)

---

**작성 일시**: 2026년 2월 13일  
**작성자**: Development Session  
**다음 Session Target**: 클래식 곡목 데이터베이스 또는 비밀번호 해싱
